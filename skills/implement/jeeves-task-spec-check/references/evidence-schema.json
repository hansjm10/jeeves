{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Task Spec-Check Evidence",
  "description": "Structured criterion-level evidence produced by the jeeves-task-spec-check skill during task specification verification.",
  "type": "object",
  "required": ["schemaVersion", "taskId", "verdict", "criteria"],
  "properties": {
    "schemaVersion": {
      "type": "integer",
      "const": 1,
      "description": "Schema version for forward compatibility."
    },
    "taskId": {
      "type": "string",
      "description": "The task identifier being verified (e.g., 'T1', 'T2')."
    },
    "verdict": {
      "type": "string",
      "enum": ["PASS", "FAIL", "INCONCLUSIVE"],
      "description": "Overall verdict for the task. PASS only if all criteria pass and filesAllowed is clean."
    },
    "criteria": {
      "type": "array",
      "description": "Per-criterion verification results.",
      "items": {
        "type": "object",
        "required": ["criterion", "verdict", "evidence"],
        "properties": {
          "criterion": {
            "type": "string",
            "description": "The acceptance criterion text being verified."
          },
          "verdict": {
            "type": "string",
            "enum": ["PASS", "FAIL", "INCONCLUSIVE"],
            "description": "Verdict for this specific criterion."
          },
          "reason": {
            "type": "string",
            "description": "Human-readable explanation of the verdict."
          },
          "evidence": {
            "type": "array",
            "description": "Evidence items supporting the verdict.",
            "items": {
              "type": "object",
              "required": ["type", "description", "confidence"],
              "properties": {
                "type": {
                  "type": "string",
                  "enum": ["file_inspection", "command_output", "test_result", "file_existence"],
                  "description": "Category of evidence."
                },
                "description": {
                  "type": "string",
                  "description": "Human-readable description of what was observed."
                },
                "location": {
                  "type": "string",
                  "description": "Reference to evidence source (e.g., 'src/handler.ts:45', 'pnpm test output')."
                },
                "confidence": {
                  "type": "number",
                  "minimum": 0,
                  "maximum": 1,
                  "description": "Confidence level in this evidence item. 0 = no confidence, 1 = fully verified."
                }
              },
              "additionalProperties": false
            },
            "minItems": 1
          }
        },
        "additionalProperties": false
      },
      "minItems": 1
    },
    "filesAllowed": {
      "type": "object",
      "description": "File permission compliance check results.",
      "properties": {
        "verdict": {
          "type": "string",
          "enum": ["PASS", "FAIL"],
          "description": "Whether all modified files match allowed patterns."
        },
        "modifiedFiles": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["path", "matchedPattern"],
            "properties": {
              "path": {
                "type": "string",
                "description": "Path of the modified file."
              },
              "matchedPattern": {
                "type": ["string", "null"],
                "description": "The filesAllowed pattern this file matched, or null if no match (violation)."
              }
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
